<!DOCTYPE html>
<html>
<head>
    <title>Graph Theory | Discrete Math Calculator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    {% extends "base.html" %}

    {% block title %}Graph Theory | Discrete Math Calculator{% endblock %}

    {% block content %}
    <div class="container">
        <h1>Graph Theory Calculator</h1>
        
        <div class="card">
            <div class="card-header">
                <h3><i class="fas fa-project-diagram"></i> Graph Visualization</h3>
            </div>
            <div class="card-body">
                <div class="visualization-controls">
                    <div class="control-group">
                        <button id="addNodeBtn" class="btn btn-primary">
                            <i class="fas fa-plus-circle"></i> Add Node
                        </button>
                        <button id="addEdgeBtn" class="btn btn-primary">
                            <i class="fas fa-link"></i> Add Edge
                        </button>
                        <button id="clearGraphBtn" class="btn btn-outline">
                            <i class="fas fa-trash"></i> Clear Graph
                        </button>
                    </div>
                    <div class="control-group">
                        <button id="saveGraphBtn" class="btn btn-primary">
                            <i class="fas fa-save"></i> Save Graph
                        </button>
                        <button id="loadGraphBtn" class="btn btn-primary">
                            <i class="fas fa-upload"></i> Load Graph
                        </button>
                    </div>
                </div>
                <div class="graph-presets">
                    <h4>Quick Graph Templates</h4>
                    <div class="preset-buttons">
                        <button class="btn btn-outline preset-btn" data-preset="complete">Complete Graph</button>
                        <button class="btn btn-outline preset-btn" data-preset="cycle">Cycle Graph</button>
                        <button class="btn btn-outline preset-btn" data-preset="star">Star Graph</button>
                        <button class="btn btn-outline preset-btn" data-preset="path">Path Graph</button>
                        <button class="btn btn-outline preset-btn" data-preset="bipartite">Bipartite Graph</button>
                    </div>
                </div>
                <div id="graphVisualization" style="height: 400px; border: 1px solid #ddd; border-radius: 4px;"></div>
                <div class="graph-info">
                    <div class="info-item">
                        <span class="info-label">Nodes:</span>
                        <span id="nodeCount">0</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Edges:</span>
                        <span id="edgeCount">0</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Density:</span>
                        <span id="graphDensity">0</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h3><i class="fas fa-calculator"></i> Graph Algorithms</h3>
            </div>
            <div class="card-body">
                <div class="algorithm-controls">
                    <div class="form-group">
                        <label for="algorithmType">Select Algorithm:</label>
                        <select id="algorithmType" class="form-control">
                            <option value="bfs">Breadth-First Search (BFS)</option>
                            <option value="dfs">Depth-First Search (DFS)</option>
                            <option value="shortestPath">Shortest Path</option>
                            <option value="minimumSpanningTree">Minimum Spanning Tree</option>
                            <option value="topologicalSort">Topological Sort</option>
                            <option value="eulerianPath">Eulerian Path</option>
                            <option value="hamiltonianPath">Hamiltonian Path</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="startNode">Start Node:</label>
                        <input type="text" id="startNode" class="form-control" placeholder="Enter start node" aria-label="Start Node" required>
                    </div>
                    <div class="form-group" id="endNodeGroup" style="display: none;">
                        <label for="endNode">End Node:</label>
                        <input type="text" id="endNode" class="form-control" placeholder="Enter end node" aria-label="End Node" required>
                    </div>
                    <div class="form-group">
                        <label for="algorithmSpeed">Animation Speed:</label>
                        <input type="range" id="algorithmSpeed" class="form-control" min="1" max="10" value="5">
                    </div>
                </div>
                <button id="runAlgorithmBtn" class="btn btn-primary" aria-label="Run Algorithm">
                    <i class="fas fa-play"></i> Run Algorithm
                </button>
                <div id="algorithmResult" class="result-container" style="display: none;" tabindex="0" aria-live="polite">
                    <h3><i class="fas fa-info-circle"></i> Result</h3>
                    <div id="algorithmResultContent"></div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h3><i class="fas fa-chart-bar"></i> Graph Properties</h3>
            </div>
            <div class="card-body">
                <div class="property-controls">
                    <button id="checkPropertiesBtn" class="btn btn-primary" aria-label="Check Properties">
                        <i class="fas fa-check"></i> Check Properties
                    </button>
                    <button id="exportPropertiesBtn" class="btn btn-outline" aria-label="Export Properties">
                        <i class="fas fa-file-export"></i> Export Properties
                    </button>
                </div>
                <div id="propertiesResult" class="result-container" style="display: none;" tabindex="0" aria-live="polite">
                    <h3><i class="fas fa-info-circle"></i> Graph Properties</h3>
                    <div id="propertiesResultContent"></div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h3><i class="fas fa-lightbulb"></i> Tips & Examples</h3>
            </div>
            <div class="card-body">
                <div class="tips-container">
                    <div class="tip-item">
                        <h4><i class="fas fa-info-circle"></i> Quick Start</h4>
                        <p>Use the preset buttons to quickly create common graph types, or add nodes and edges manually.</p>
                    </div>
                    <div class="tip-item">
                        <h4><i class="fas fa-mouse-pointer"></i> Interaction</h4>
                        <p>Click and drag nodes to rearrange them. Double-click a node to edit its label.</p>
                    </div>
                    <div class="tip-item">
                        <h4><i class="fas fa-code"></i> Keyboard Shortcuts</h4>
                        <ul>
                            <li><kbd>N</kbd> Add new node</li>
                            <li><kbd>E</kbd> Add new edge</li>
                            <li><kbd>Del</kbd> Delete selected node/edge</li>
                            <li><kbd>Ctrl + S</kbd> Save graph</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Required Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet">

    <!-- Application Scripts -->
    <script src="{{ url_for('static', filename='js/automata/utils.js') }}"></script>
    <script src="{{ url_for('static', filename='js/graph_visualization.js') }}"></script>

    <!-- MathJax -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    {% endblock %}

    {% block extra_css %}
    <style>
    .special-graphs-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .special-graph-card {
        background-color: var(--surface-0);
        border-radius: var(--radius-lg);
        padding: var(--space-6);
        text-align: center;
        box-shadow: var(--shadow-md);
        transition: var(--transition-normal);
    }

    .special-graph-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
    }

    .special-graph-card h4 {
        color: var(--primary-dark);
        margin-top: 0;
        margin-bottom: var(--space-4);
    }

    .graph-image {
        height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: var(--space-4);
        color: var(--primary);
    }

    .special-graph-card p {
        color: var(--gray-500);
        margin-bottom: var(--space-4);
        min-height: 60px;
    }

    .generate-btn {
        width: 100%;
    }

    .visualization-container {
        margin-top: var(--space-8);
        border: 1px solid var(--gray-200);
        border-radius: var(--radius-lg);
        background-color: var(--surface-0);
        padding: var(--space-6);
        min-height: 300px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .form-actions {
        display: flex;
        gap: var(--space-2);
    }

    .algorithm-step {
        margin-bottom: var(--space-4);
        padding-bottom: var(--space-4);
        border-bottom: 1px dashed var(--gray-200);
    }

    .algorithm-step:last-child {
        border-bottom: none;
    }

    .edge-list {
        list-style: none;
        padding: 0;
    }

    .edge-list li {
        display: inline-block;
        background-color: #f0f6ff;
        padding: 5px 10px;
        margin: 5px;
        border-radius: 4px;
        font-family: 'Roboto Mono', monospace;
    }

    .vertex-set {
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-2);
        margin-top: var(--space-2);
    }

    .vertex {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--primary-light);
        color: white;
        font-weight: 500;
    }

    .vertex.visited {
        background-color: var(--success);
    }

    .vertex.current {
        background-color: var(--warning);
        color: var(--dark);
        animation: pulse 1s infinite;
    }

    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); }
    }

    .alert {
        padding: 10px 15px;
        margin-bottom: 10px;
        border-radius: 4px;
        opacity: 1;
        transition: opacity 0.3s ease-in-out;
    }

    .alert-error {
        background-color: #ffebee;
        color: #c62828;
        border: 1px solid #ffcdd2;
    }

    .alert-success {
        background-color: #e8f5e9;
        color: #2e7d32;
        border: 1px solid #c8e6c9;
    }

    .visualization-controls {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-bottom: 20px;
    }

    .control-group {
        display: flex;
        gap: 10px;
    }

    .graph-presets {
        margin: 20px 0;
        padding: 15px;
        background-color: #f8f9fa;
        border-radius: var(--border-radius);
    }

    .graph-presets h4 {
        margin-bottom: 10px;
        color: var(--primary);
    }

    .preset-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }

    .preset-btn {
        font-size: 0.9rem;
        padding: 8px 15px;
    }

    .graph-info {
        display: flex;
        gap: 20px;
        margin-top: 15px;
        padding: 10px;
        background-color: #f8f9fa;
        border-radius: var(--border-radius);
    }

    .info-item {
        display: flex;
        align-items: center;
        gap: 5px;
    }

    .info-label {
        font-weight: 500;
        color: var(--primary);
    }

    .algorithm-controls {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
    }

    .property-controls {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
    }

    .tips-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: var(--space-6);
    }

    .tip-item {
        padding: var(--space-4);
        background-color: var(--surface-100);
        border-radius: var(--radius-lg);
        border-left: 4px solid var(--primary);
    }

    .tip-item h4 {
        color: var(--primary);
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .tip-item ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .tip-item li {
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    kbd {
        background-color: #eee;
        border-radius: 3px;
        border: 1px solid #b4b4b4;
        box-shadow: 0 1px 1px rgba(0,0,0,.2);
        color: #333;
        display: inline-block;
        font-size: 0.85em;
        font-weight: 700;
        line-height: 1;
        padding: 2px 4px;
        white-space: nowrap;
    }

    @media (max-width: 768px) {
        .visualization-controls {
            flex-direction: column;
        }
        
        .control-group {
            flex-wrap: wrap;
        }
        
        .graph-info {
            flex-direction: column;
            gap: 10px;
        }
        
        .algorithm-controls {
            grid-template-columns: 1fr;
        }
    }

    .theme-toggle {
        position: fixed;
        bottom: var(--space-6);
        right: var(--space-6);
        background: var(--primary);
        color: var(--white);
        border: none;
        border-radius: var(--radius-full);
        width: 3rem;
        height: 3rem;
        font-size: 1.25rem;
        cursor: pointer;
        box-shadow: var(--shadow-lg);
        transition: var(--transition-fast);
        z-index: 1000;
    }

    .theme-toggle:focus {
        outline: 2px solid var(--primary-dark);
    }

    .theme-toggle[aria-label] {
        outline: none;
    }

    .visualization-container[role="region"][aria-label="Graph Visualization"] {}
    </style>
    {% endblock %}

    {% block extra_js %}
    <script src="{{ url_for('static', filename='js/graph_theory.js') }}"></script>
    {% endblock %}
</body>
</html>
